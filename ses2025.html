<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>環境科学会2025年度年会 発表関連資料</title>
  <meta name="description" content="環境科学会2025年度年会での発表『第六次環境基本計画策定をめぐる意見の貢献度分析：重み付けおよび可視化による定量的アプローチ』に関わる資料・データへのリンク集。" />
  <style>
    :root { --maxw: 780px; --pad: 1rem; --radius: 14px; }
    * { box-sizing: border-box; }
    html { -webkit-text-size-adjust: 100%; }
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", "Hiragino Kaku Gothic ProN", "Yu Gothic Medium", "Yu Gothic", Meiryo, sans-serif; line-height: 1.65; margin: 0; color: #121212; background: #ffffff; }
    a { color: #0b57d0; }
    @media (prefers-color-scheme: dark) {
      body { color: #eaeaea; background: #0b0b0b; }
      a { color: #8ab4f8; }
      .link { border-color: #222; background: #121212; }
      .link:hover, .link:focus-visible { background: #161616; }
    }

    header { padding: clamp(1rem, 3vw, 2rem) var(--pad) 0; }
    main { max-width: var(--maxw); margin: 0 auto; padding: 0 var(--pad) 3rem; }
    h1 { font-size: clamp(1.25rem, 3.5vw, 1.8rem); margin: .2rem 0 .6rem; line-height: 1.3; }
    p.lead { margin: 0 0 .75rem; font-size: 1rem; opacity: .88; }

    ul.links { list-style: none; margin: 1rem 0 0; padding: 0; }
    ul.links li { margin: .5rem 0; }
    .link { display: block; padding: .9rem 1rem; border: 1px solid #e4e4e7; border-radius: var(--radius); text-decoration: none; background: #fff; }
    .link:hover, .link:focus-visible { outline: none; background: #f6f6f8; }
    .note { display: block; margin-top: .25rem; opacity: .7; font-size: .9rem; }
    .badge { font-size: .75rem; padding: .2rem .5rem; border-radius: .5rem; border: 1px solid #d4d4d8; margin-left: .5rem; }
    .external::after { content: " \2197"; }

    footer { margin-top: 2rem; font-size: .85rem; opacity: .75; }

    @media (hover: none) { .link { padding: 1rem; } }
    .btn { display:inline-block; padding:.65rem 1rem; border:1px solid #d4d4d8; border-radius: .6rem; background:#fff; cursor:pointer; }
  .btn:hover, .btn:focus-visible { background:#f6f6f8; }
  .filter { margin-left:.5rem; padding:.55rem .7rem; border:1px solid #d4d4d8; border-radius:.5rem; min-width: 12rem; }
  .csv-controls { margin-top: 1.25rem; }
  .csv-view { margin-top: .75rem; }
  .csv-items { display:flex; flex-direction:column; gap:.75rem; max-height: 65vh; overflow:auto; padding-right:.25rem; }
  .item { border:1px solid #e4e4e7; border-radius: var(--radius); padding:.8rem .9rem; background:#fff; }
  .item-title { font-weight:600; margin-bottom:.35rem; }
  .item dl { margin:0; display:grid; grid-template-columns: max-content 1fr; gap:.25rem .75rem; }
  .item dt { opacity:.7; }
  .item dd { margin:0; word-break:break-word; }
  @media (prefers-color-scheme: dark) {
    .btn { background:#121212; border-color:#333; }
    .btn:hover, .btn:focus-visible { background:#161616; }
    .filter { background:#0f0f0f; color:#eee; border-color:#333; }
    .item { background:#121212; border-color:#222; }
  }
</style>
</head>
<body>
  <header>
    <main>
      <h1>環境科学会2025年度年会 発表関連資料</h1>
      <p class="lead">発表題目：「第六次環境基本計画策定をめぐる意見の貢献度分析：重み付けおよび可視化による定量的アプローチ」</p>
      <p>著者：○石井 康平, 亀田 尭宙（千葉大学大学院, 人間文化研究機構）</p>
    </main>
  </header>

  <main>
    <ul class="links">
      <li><a class="link" href="./env6plan_final_draft.html">第六次環境基本計画 案</a></li>
      <li><a class="link" href="./env6plan_final_draft_for_ses2025.html">第六次環境基本計画 変更由来の脚注付き答申案</a></li>
      <li>
        <a class="link external" href="https://www.env.go.jp/council/content/i_01/000221700.pdf" target="_blank" rel="noopener noreferrer">答申案に向けての見え消し版の修正（環境省のPDF）<span class="badge">PDF</span></a>
        <small class="note">外部サイトに移動します。</small>
      </li>
      <li><a class="link external" href="https://difff.jp/napgq.html" target="_blank" rel="noopener noreferrer">第二部三章の実際の見え消し</a></li>
      <li><a class="link" href="ses2025.csv" download>第二部三章の変更箇所まとめ <span class="badge">CSV</span></a></li>
      <li><a class="link" href="./minutes.html">113–116回 総合政策部会議事録</a></li>
      <li><a class="link" href="./viewer.html">関連する文書を発見するためのビューア</a></li>
    </ul>

    <div class="csv-controls" id="csv-controls">
      <button id="load-csv" class="btn">「第二部三章の変更箇所まとめ」を読み込んで表示</button>
      <input id="csv-filter" class="filter" type="search" placeholder="キーワードで絞り込み" aria-label="CSV内検索" />
      <small class="note">ボタンを押すと <code>ses2025.csv</code> をこのページ内で読み込みます。</small>
      <div id="csv-view" class="csv-view" hidden>
        <p class="note"><span id="csv-count"></span> 件を表示中</p>
        <div id="csv-items" class="csv-items" aria-live="polite"></div>
      </div>
    </div>

  </main>
  <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js" crossorigin="anonymous"></script>
  <script>
    const loadBtn = document.getElementById('load-csv');
    const filterInput = document.getElementById('csv-filter');
    const view = document.getElementById('csv-view');
    const itemsEl = document.getElementById('csv-items');
    const countEl = document.getElementById('csv-count');

    let rows = [];

    function render(list){
      itemsEl.innerHTML = '';
      list.forEach((row, i) => {
        const art = document.createElement('article');
        art.className = 'item';
        const titleText = row.title || row.タイトル || row.section || row.セクション || row.heading || row.見出し || `項目 ${i+1}`;
        const title = document.createElement('div');
        title.className = 'item-title';
        title.textContent = titleText;
        const dl = document.createElement('dl');
        for (const [k,v] of Object.entries(row)){
          if (v === undefined || v === null || String(v).trim() === '') continue;
          const dt = document.createElement('dt');
          dt.textContent = k;
          const dd = document.createElement('dd');
          dd.textContent = String(v);
          dl.append(dt, dd);
        }
        art.append(title, dl);
        itemsEl.append(art);
      });
      countEl.textContent = `${list.length}`;
    }

    function applyFilter(){
      const q = filterInput.value.trim().toLowerCase();
      if (!q){ render(rows); return; }
      const filtered = rows.filter(r => Object.values(r).some(v => String(v).toLowerCase().includes(q)));
      render(filtered);
    }

    loadBtn?.addEventListener('click', () => {
      loadBtn.disabled = true;
      loadBtn.textContent = '読み込み中…';
      Papa.parse('ses2025.csv', {
        download: true,
        header: true,
        skipEmptyLines: true,
        complete: (res) => {
          rows = res.data || [];
          view.hidden = false;
          render(rows);
          loadBtn.textContent = '再読み込み';
          loadBtn.disabled = false;
        },
        error: (err) => {
          alert('CSVの読み込みに失敗しました: ' + (err?.message || err));
          loadBtn.textContent = '再試行';
          loadBtn.disabled = false;
        }
      });
    });

    filterInput?.addEventListener('input', applyFilter);
  </script>
</body>
</html>
